<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>Packbase Unavailable</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Color Variables */
            --gray-1: #fafafa;
            --gray-2: #f5f5f5;
            --gray-3: #e5e5e5;
            --gray-4: #d4d4d4;
            --gray-6: #a1a1a1;
            --gray-8: #525252;
            --gray-11: #262626;
            --gray-12: #171717;

            /* Fixed Z-Index Scale */
            --z-base: 1;
            --z-elevated: 10;
            --z-overlay: 100;

            /* Spacing */
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-6: 1.5rem;
            --space-8: 2rem;

            /* Font Weights */
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;

            /* Border */
            --border-hairline: 1px;

            /* Animations */
            --duration-fast: 150ms;
            --duration-normal: 250ms;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --gray-1: #171717;
                --gray-2: #1f1f1f;
                --gray-3: #262626;
                --gray-4: #404040;
                --gray-6: #737373;
                --gray-8: #d4d4d4;
                --gray-11: #e5e5e5;
                --gray-12: #fafafa;
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: var(--gray-1);
            color: var(--gray-12);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-4);
            line-height: 1.5;
        }

        .container {
            max-width: 480px;
            width: 100%;
            text-align: left;
        }

        .icon-container {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--space-6);
            background: var(--gray-2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 0 var(--border-hairline) var(--gray-3);
        }

        .icon {
            width: 40px;
            height: 40px;
            color: var(--gray-8);
            /* Disable pointer events for decorative element */
            pointer-events: none;
            user-select: none;
        }

        h1 {
            font-size: 1.875rem;
            font-weight: var(--font-weight-semibold);
            color: var(--gray-12);
            margin-bottom: var(--space-3);
            text-wrap: balance;
            letter-spacing: -0.02em;
        }

        .description {
            font-size: 1rem;
            color: var(--gray-8);
            margin-bottom: var(--space-8);
            text-wrap: balance;
            line-height: 1.6;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            align-items: center;
        }

        .button {
            /* 44px minimum tap target for accessibility */
            min-height: 44px;
            padding: 0 var(--space-6);
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: var(--font-weight-medium);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            width: 100%;
            max-width: 320px;
            /* Prevent text selection on buttons */
            user-select: none;
            /* Specify exact properties instead of transition: all */
            transition: background-color var(--duration-fast) ease,
            transform var(--duration-fast) ease,
            box-shadow var(--duration-fast) ease;
        }

        /* Hover effects only on hover-capable devices */
        @media (hover: hover) {
            .button-secondary:hover {
                background-color: var(--gray-3);
            }
        }

        /* Secondary button */
        .button-secondary {
            background-color: var(--gray-2);
            color: var(--gray-12);
            box-shadow: 0 0 0 var(--border-hairline) var(--gray-3);
        }

        .button-secondary:active {
            background-color: var(--gray-3);
        }

        /* Focus states for keyboard navigation */
        .button:focus-visible {
            outline: 2px solid var(--gray-12);
            outline-offset: 2px;
        }

        .status-message {
            margin-top: var(--space-6);
            padding: var(--space-4);
            background: var(--gray-2);
            border-radius: 8px;
            font-size: 0.875rem;
            color: var(--gray-8);
            box-shadow: 0 0 0 var(--border-hairline) var(--gray-3);
        }

        /* Safe areas for notched devices */
        @supports (padding: env(safe-area-inset-top)) {
            body {
                padding: max(var(--space-4), env(safe-area-inset-top)) max(var(--space-4), env(safe-area-inset-right)) max(var(--space-4), env(safe-area-inset-bottom)) max(var(--space-4), env(safe-area-inset-left));
            }
        }

        /* Responsive adjustments */
        @media (min-width: 640px) {
            .actions {
                flex-direction: row;
                justify-content: center;
            }

            .button {
                width: auto;
                min-width: 140px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="icon-container" role="img" aria-label="Unavailable service icon">
        <!-- Cloud off icon -->
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
             stroke-linejoin="round" aria-hidden="true">
            <path d="M22.61 16.95A5 5 0 0 0 18 10h-1.26a8 8 0 0 0-7.05-6M5 5a8 8 0 0 0 4 15h9a5 5 0 0 0 1.7-.3"></path>
            <line x1="1" y1="1" x2="23" y2="23"></line>
        </svg>
    </div>

    <h1>Packbase is unavailable</h1>

    <p class="description">
        The server couldn't communicate properly with Packbase - We'll keep retrying in the background. We recommend you
        come back later, or join our Discord for updates.
    </p>

    <div class="actions">
        <a href="/" class="button button-secondary" aria-label="Return to homepage">
            Join Discord
        </a>
    </div>

    <div class="status-message">
        <div class="status-indicator">
            <span>Retrying in <span id="countdown" style="font-variant-numeric: tabular-nums">30</span>s</span>
        </div>
    </div>
</div>

<script>
    // Auto-refresh every 30 seconds to check if service is back
    // Only when the page is visible (respect battery/performance)
    const REFRESH_INTERVAL = 30;
    let refreshTimer;
    let countdownTimer;
    let secondsRemaining = REFRESH_INTERVAL;
    const countdownEl = document.getElementById('countdown');

    function updateCountdown() {
        countdownEl.textContent = secondsRemaining;
        secondsRemaining--;

        if (secondsRemaining < 0) {
            location.reload();
        }
    }

    function scheduleRefresh() {
        if (!document.hidden) {
            secondsRemaining = REFRESH_INTERVAL;
            updateCountdown();

            countdownTimer = setInterval(() => {
                updateCountdown();
            }, 1000);
        }
    }

    function clearTimers() {
        clearTimeout(refreshTimer);
        clearInterval(countdownTimer);
    }

    // Handle visibility changes
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            clearTimers();
        } else {
            scheduleRefresh();
        }
    });

    // Start refresh timer on load
    scheduleRefresh();

    // Keyboard navigation - reload on Enter/Space when focused on buttons
    document.addEventListener('keydown', (e) => {
        if (e.target.tagName === 'BUTTON' && (e.key === 'Enter' || e.key === ' ')) {
            e.preventDefault();
            e.target.click();
        }
    });
</script>
</body>
</html>
